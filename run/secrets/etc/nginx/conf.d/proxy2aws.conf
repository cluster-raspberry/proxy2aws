#########################################################################
#      Copyright (C) 2020        Sebastian Francisco Colomar Bauza      #
#      SPDX-License-Identifier:  GPL-2.0-only                           #
#########################################################################
server {                                                                #
  listen 8080                                                           ;
  location / {                                                          #
    index  index.html index.htm                                         ;
    root /usr/share/nginx/html                                          ;
  }                                                                     #
  location /cloud/www.upm.es/ {                                         #
    auth_basic "AWS to Cloud"                                           ;
    auth_basic_user_file /etc/nginx/aws2cloud.htpasswd                  ;
    proxy_pass https://www.upm.es                                       ;
    rewrite ^/cloud/www.upm.es/(.*)$ /$1 break                          ;
  }                                                                     #
  location /cloud/www.upv.es/ {                                         #
    auth_basic "AWS to Cloud"                                           ;
    auth_basic_user_file /etc/nginx/aws2cloud.htpasswd                  ;
    proxy_pass https://www.upv.es                                       ;
    rewrite ^/cloud/www.upv.es/(.*)$ /$1 break                          ;
  }                                                                     #
  location /prem/ {                                                     #
    proxy_pass https://www.upm.es                                       ;
    proxy_set_header Authorization "Basic dXNlcjpwYXNzd29yZA=="         ;
    rewrite ^/prem/(.*)$ /$1 break                                      ;
  }                                                                     #
  server_name localhost                                                 ;
}                                                                       #
#########################################################################
